<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí¨ ChatAPI Ryzumi</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"/>

<style>
body{
  font-family:Inter,sans-serif;
  margin:0;
  background:#1f1f1f;
  color:#fff;
  display:flex;
  flex-direction:column;
  height:100vh;
}
header{
  padding:15px;
  background:#2a2a2a;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header select{
  background:#333;
  color:#fff;
  border:none;
  border-radius:8px;
  padding:8px;
}
.chat-container{
  flex:1;
  padding:20px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.bubble{
  max-width:80%;
  padding:12px 15px;
  border-radius:15px;
  word-break:break-word;
  white-space:pre-wrap;
}
.user{
  background:#4f46e5;
  align-self:flex-end;
}
.api{
  background:#333;
  align-self:flex-start;
}
.loading-indicator{
  font-style:italic;
  color:#aaa;
}
footer{
  padding:15px;
  background:#2a2a2a;
}
.controls{
  display:flex;
  gap:10px;
}
input{
  flex:1;
  padding:10px;
  border-radius:8px;
  border:none;
  background:#333;
  color:white;
}
button{
  padding:10px 15px;
  border:none;
  border-radius:8px;
  background:#4f46e5;
  color:white;
  cursor:pointer;
}
button:hover{
  background:#6366f1;
}
</style>
</head>

<body>

<header>
  <h3>adr6hmn.com</h3>
  <select id="endpoint">
    <option value="ai/chatgpt">AI - ChatGPT</option>
    <option value="ai/gemini">AI - Gemini</option>
    <option value="ai/deepseek">AI - DeepSeek</option>
  </select>
</header>

<div class="chat-container" id="chatContainer"></div>

<footer>
  <div class="controls">
    <input type="text" id="inputData" placeholder="Tulis pesan..." onkeydown="if(event.key==='Enter'){callApi()}">
    <button onclick="callApi()">Kirim</button>
  </div>
</footer>

<script>
const chatContainer = document.getElementById("chatContainer");
const inputText = document.getElementById("inputData");

function getCurrentEndpoint(){
  return document.getElementById("endpoint").value;
}

function addBubble(text,from="api"){
  const div=document.createElement("div");
  div.className="bubble "+from;
  div.innerHTML=text;
  chatContainer.appendChild(div);
  chatContainer.scrollTop=chatContainer.scrollHeight;
  return div;
}

async function callApi(){
  const endpoint=getCurrentEndpoint();
  const input=inputText.value.trim();
  if(!input) return;

  addBubble(input,"user");
  inputText.value="";

  const loadingBubble=addBubble("Sedang memproses...","api");
  loadingBubble.classList.add("loading-indicator");

  const apiUrl=`https://api.ryzumi.vip/api/${endpoint}?text=${encodeURIComponent(input)}`;
  console.log("Request ke:",apiUrl);

  try{
    const res=await fetch(apiUrl,{
      method:"GET",
      mode:"cors"
    });

    loadingBubble.remove();

    if(!res.ok){
      throw new Error("Status "+res.status+" - "+res.statusText);
    }

    const contentType=res.headers.get("content-type") || "";

    if(contentType.includes("application/json")){
      const json=await res.json();
      if(json.result){
        addBubble(json.result,"api");
      }else if(json.answer){
        addBubble(json.answer,"api");
      }else{
        addBubble(JSON.stringify(json,null,2),"api");
      }
    }else{
      const text=await res.text();
      addBubble(text.substring(0,500),"api");
    }

  }catch(err){
    loadingBubble.remove();
    addBubble("‚ùå ERROR: "+err.message,"api");
  }
}
</script>

</body>
</html>
